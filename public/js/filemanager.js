(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{159:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(e,t,n){return e.$buefy.toast.open({duration:5e3,message:n,position:"is-top",type:"is-"+t})}},160:function(e,t,n){"use strict";var i=n(4),a=new(n.n(i).a);t.a=a},162:function(e,t,n){"use strict";var i=n(1),a=n.n(i);t.a={getData:function(e,t){return a.a.get("/api/filemanager/data",{params:{folder:e,userId:t}}).then((function(e){return e.data}))},createFolder:function(e,t,n){return a.a.post("/api/filemanager/actions/create-folder",{folder:e,current:t,userId:n}).then((function(e){return e.data}))},removeDirectory:function(e,t){return a.a.post("/api/filemanager/actions/delete-folder",{current:e,userId:t}).then((function(e){return e.data}))},getInfo:function(e,t){return a.a.post("/api/filemanager/actions/get-info",{file:e,userId:t}).then((function(e){return e.data}))},removeFile:function(e,t){return a.a.post("/api/filemanager/actions/remove-file",{file:e,userId:t}).then((function(e){return e.data}))},renameFile:function(e,t,n){return a.a.post("/api/filemanager/actions/rename-file",{file:e,name:t,userId:n}).then((function(e){return e.data}))},rename:function(e,t,n){return a.a.post("/api/filemanager/actions/rename",{path:e,name:t,userId:n}).then((function(e){return e.data}))}}},168:function(e,t,n){var i=n(346);"string"==typeof i&&(i=[[e.i,i,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(89)(i,a);i.locals&&(e.exports=i.locals)},336:function(e,t,n){var i=n(412);"string"==typeof i&&(i=[[e.i,i,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(89)(i,a);i.locals&&(e.exports=i.locals)},337:function(e,t,n){var i=n(417);"string"==typeof i&&(i=[[e.i,i,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(89)(i,a);i.locals&&(e.exports=i.locals)},340:function(e,t,n){var i=n(421);"string"==typeof i&&(i=[[e.i,i,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(89)(i,a);i.locals&&(e.exports=i.locals)},345:function(e,t,n){"use strict";var i=n(168);n.n(i).a},346:function(e,t,n){(e.exports=n(88)(!1)).push([e.i,"[data-v-0850c8b2] .breadcrumb ul {\n  margin: 0;\n}\n[data-v-0850c8b2] .breadcrumb ul li {\n  margin: 0;\n}\n[data-v-0850c8b2] .breadcrumb ul li:not(.is-active) a {\n  font-weight: 600;\n}\n[data-v-0850c8b2] .files > div {\n  display: flex;\n  flex-wrap: wrap;\n}\n[data-v-0850c8b2] .files .w-100 {\n  width: 100%;\n}\n[data-v-0850c8b2] .files .text-center {\n  text-align: center;\n}\n[data-v-0850c8b2] .files .my-4 {\n  margin: 2rem 0;\n}\n[data-v-0850c8b2] .files .grid {\n  width: 200px;\n  height: 200px;\n  margin-right: 1rem;\n  margin-bottom: 1rem;\n  overflow: hidden;\n  position: relative;\n}\n[data-v-0850c8b2] .files .grid:hover .folder-item .main-svg,[data-v-0850c8b2] .files .grid:hover .file-item .image-block,[data-v-0850c8b2] .files .grid:hover .file-item .mime-icon {\n  opacity: 0.5;\n}\n[data-v-0850c8b2] .files .grid:hover .folder-item .actions-grid,[data-v-0850c8b2] .files .grid:hover .file-item .actions-grid {\n  display: flex;\n}\n[data-v-0850c8b2] .files .grid .folder-item,[data-v-0850c8b2] .files .grid .file-item {\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  margin: 0;\n}\n[data-v-0850c8b2] .files .grid .folder-item .name,[data-v-0850c8b2] .files .grid .file-item .name {\n  position: absolute;\n  bottom: 0;\n  width: 100%;\n  background: #f8f9fa;\n  font-size: 0.85rem;\n  text-align: center;\n  padding: 0.3rem 0;\n  cursor: pointer;\n  font-weight: 600;\n}\n[data-v-0850c8b2] .files .grid .folder-item .actions-grid,[data-v-0850c8b2] .files .grid .file-item .actions-grid {\n  position: absolute;\n  display: none;\n  right: 7px;\n  top: 7px;\n  color: var(--manatee);\n}\n[data-v-0850c8b2] .files .grid .folder-item .actions-grid > div,[data-v-0850c8b2] .files .grid .file-item .actions-grid > div {\n  display: flex;\n}\n[data-v-0850c8b2] .files .grid .folder-item .actions-grid.is-select,[data-v-0850c8b2] .files .grid .file-item .actions-grid.is-select {\n  display: flex !important;\n}\n[data-v-0850c8b2] .files .grid .folder-item .actions-grid span.icon,[data-v-0850c8b2] .files .grid .file-item .actions-grid span.icon {\n  cursor: pointer;\n}\n[data-v-0850c8b2] .files .grid .folder-item .actions-grid span.icon i:before,[data-v-0850c8b2] .files .grid .file-item .actions-grid span.icon i:before {\n  font-size: 1.4rem;\n}\n[data-v-0850c8b2] .files .grid .folder-item .actions-grid span.icon.trash,[data-v-0850c8b2] .files .grid .file-item .actions-grid span.icon.trash {\n  margin-right: 0.3rem;\n}\n[data-v-0850c8b2] .files .grid .file-item .image-block {\n  position: absolute;\n  transition: opacity 0.3s;\n  top: 39px;\n}\n[data-v-0850c8b2] .files .grid .file-item .image-block .block-grid {\n  width: 150px;\n  height: 130px;\n  background-size: cover;\n  background-position: top center;\n  background-repeat: no-repeat;\n  border-radius: 0.25rem 0.25rem 0 0;\n}\n[data-v-0850c8b2] .files .grid .file-item .mime-icon {\n  transition: opacity 0.3s;\n  margin-top: -25px;\n}\n[data-v-0850c8b2] .files .grid .file-item .mime-icon svg {\n  width: 90px;\n  height: 90px;\n  fill: gainsboro;\n}\n[data-v-0850c8b2] .files .grid .folder-item .main-svg {\n  color: gainsboro;\n  transition: opacity 0.3s;\n  margin-top: -25px;\n}\n[data-v-0850c8b2] .files .grid .folder-item .main-svg i:not(.mdi-undo-variant):before {\n  font-size: 7rem;\n}\n[data-v-0850c8b2] .files .grid .folder-item .main-svg i.mdi-undo-variant:before {\n  font-size: 3rem;\n}\n[data-v-0850c8b2] .custom-control-label::after,[data-v-0850c8b2] .custom-control-label::before {\n  top: 0;\n  left: -1.25rem;\n  width: 1.15rem;\n  height: 1.15rem;\n}",""])},347:function(e,t,n){var i=n(514);"string"==typeof i&&(i=[[e.i,i,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(89)(i,a);i.locals&&(e.exports=i.locals)},353:function(e,t,n){"use strict";n(34),n(104),n(338),n(182),n(179),n(184),n(335),n(49),n(165),n(10),n(48),n(183),n(172),n(173),n(90),n(174),n(339),n(368),n(369);var i=n(3),a=n(25),s=n(0),r=n.n(s),o=n(46),l=(n(11),n(2)),d=n(91),c=n.n(d),u=n(372),f=n.n(u),m=n(373),p=n.n(m),h=n(162),v=n(169),g=n.n(v),b=(n(181),n(185)),y=n.n(b),_=n(160),x=n(20),F={props:{file:{type:Object,default:function(){return{name:""}},required:!0},multiSelecting:{type:Boolean,default:!1,required:!1},selectedFiles:{type:Array,default:function(){return[]},required:!1},deletePermission:{type:Boolean,required:!1,default:!0},renamePermission:{type:Boolean,required:!1,default:!0}},computed:Object(i.a)(Object(i.a)({},Object(x.c)({showModal:function(e){return e.settings.filemanager.showModal}})),{},{selected:function(){return this.showModal?y()(this.selectedFiles,{id:this.file.id,mime:this.file.mime,path:this.file.asset})>=0:y()(this.selectedFiles,{type:this.file.type,path:this.file.path})>=0}}),mounted:function(){var e=this;if("image"===this.file.mime){var t=document.createElement("div");t.style.backgroundImage="url('"+this.file.thumb+"')",t.className="block-grid",t.draggable=!1,this.$refs.image.appendChild(t)}_.a.$on("removeSelectedInModal",(function(t){e.selectedFiles=t}))},methods:{clickStrategy:function(){return this.showModal||this.multiSelecting?this.select():this.showInfo()},select:function(){this.showModal?this.$emit("select",{id:this.file.id,mime:this.file.mime,path:this.file.asset}):this.$emit("select",{type:this.file.type,path:this.file.path})},showInfo:function(){this.$emit("showInfo",this.file)},deleteFile:function(e){this.stopDefaultActions(e),_.a.$emit("openModal","delete"),_.a.$emit("delete","file",this.file.path)},renameFile:function(e){this.stopDefaultActions(e),_.a.$emit("openModal","rename"),_.a.$emit("rename","file",this.file.path)},stopDefaultActions:function(e){e.preventDefault(),e.stopPropagation()}},filters:{truncate:function(e,t,n){return e.slice(0,t)+(t<e.length?n||"...":"")}}},w=n(47),C=Object(w.a)(F,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("transition",{attrs:{name:"fade"}},[n("div",{staticClass:"card",on:{click:function(t){return t.preventDefault(),e.clickStrategy(t)}}},["image"!==e.file.mime?n("div",{staticClass:"mime-icon",domProps:{innerHTML:e._s(e.file.thumb)}}):e._e(),e._v(" "),"image"===e.file.mime?n("div",{ref:"image",staticClass:"image-block"}):e._e(),e._v(" "),e.showModal?e._e():n("div",{class:["actions-grid",{"is-select":e.multiSelecting}]},[e.multiSelecting?n("b-checkbox",{model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}}):n("div",[e.deletePermission?n("b-icon",{staticClass:"trash",attrs:{icon:"delete-sweep"},nativeOn:{click:function(t){return t.preventDefault(),e.deleteFile(t)}}}):e._e(),e._v(" "),e.renamePermission?n("b-icon",{attrs:{icon:"square-edit-outline"},nativeOn:{click:function(t){return t.preventDefault(),e.renameFile(t)}}}):e._e()],1)],1),e._v(" "),e.showModal?n("div",{staticClass:"actions-grid is-select is-modal"},[n("b-checkbox",{model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1):e._e(),e._v(" "),n("div",{staticClass:"name"},[e._v("\n            "+e._s(e._f("truncate")(e.file.name,25))+"\n        ")])])])}),[],!1,null,null,null).exports,k={props:{file:{type:Object,default:function(){return{name:""}},required:!0},multiSelecting:{type:Boolean,default:!1,required:!1},selectedFiles:{type:Array,default:function(){return[]},required:!1},deletePermission:{type:Boolean,required:!1,default:!0},renamePermission:{type:Boolean,required:!1,default:!0}},data:function(){return{loading:!0,missing:!1}},mounted:function(){this.loading=!1},computed:Object(i.a)(Object(i.a)({},Object(x.c)({showModal:function(e){return e.settings.filemanager.showModal}})),{},{selected:function(){return y()(this.selectedFiles,{type:this.file.type,path:this.file.path})>=0}}),methods:{clickStrategy:function(){return this.multiSelecting?this.select():this.goToFolder()},goToFolder:function(){this.$emit("goToFolderEvent",this.file.path)},deleteFolder:function(e){this.stopDefaultActions(e),_.a.$emit("openModal","delete"),_.a.$emit("delete","folder",this.file.path)},editFolder:function(e){this.stopDefaultActions(e),_.a.$emit("openModal","rename"),_.a.$emit("rename","folder",this.file.path)},stopDefaultActions:function(e){e.preventDefault(),e.stopPropagation()},select:function(){this.$emit("select",{type:this.file.type,path:this.file.path})}}},I=Object(w.a)(k,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("transition",{attrs:{name:"fade"}},[n("div",{on:{click:function(t){return t.preventDefault(),e.clickStrategy(t)}}},["folder_back"===e.file.id?[n("b-icon",{staticClass:"main-svg",attrs:{icon:"undo-variant"}}),e._v(" "),n("div",{staticClass:"name"},[e._v("Назад")])]:[n("b-icon",{staticClass:"main-svg",attrs:{icon:"folder"}}),e._v(" "),e.showModal?e._e():n("div",{class:["actions-grid",{"is-select":e.multiSelecting}]},[e.multiSelecting?n("b-checkbox",{model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}}):n("div",[e.deletePermission?n("b-icon",{staticClass:"trash",attrs:{icon:"delete-sweep"},nativeOn:{click:function(t){return t.preventDefault(),e.deleteFolder(t)}}}):e._e(),e._v(" "),e.renamePermission?n("b-icon",{attrs:{icon:"square-edit-outline"},nativeOn:{click:function(t){return t.preventDefault(),e.editFolder(t)}}}):e._e()],1)],1),e._v(" "),n("div",{staticClass:"name"},[e._v("\n                "+e._s(e.file.name)+"\n            ")])]],2)])}),[],!1,null,null,null).exports,$=n(159),O={name:"Manager",components:{vueCustomScrollbar:g.a,ImageLoader:C,Folder:I},props:{files:{default:function(){return[]},required:!0},path:{default:function(){return[]},required:!0},userId:{type:Number,default:0,required:!0},current:{type:String,default:"/",required:!0},parent:{type:Object,required:!0},noFiles:{type:Boolean,default:!1,required:!0},home:{type:String,required:!1,default:"/"},search:{type:String,required:!1,default:""},filters:{type:Array,required:!1,default:function(){return[]}},multiSelecting:{type:Boolean,default:!1,required:!1},selectedFiles:{type:Array,default:function(){return[]},required:!1},buttons:{default:function(){return[]},required:!0}},data:function(){return{info:{},loadingInfo:!1,firstUploadFolder:null}},methods:{goToFolder:function(e){this.$emit("goToFolderManager",e)},goToFolderNav:function(e){this.$emit("goToFolderManagerNav",e)},checkIsLastItem:function(e){return c.a.size(this.path)===parseInt(e)+1},removeDirectory:function(){var e=this;h.a.removeDirectory(this.current,this.userId).then((function(t){e.$emit("goToFolderManager",e.getParentFolder()),_.a.$emit("refreshFilemanager"),Object($.a)(e,"success",t.message)})).catch((function(t){void 0!==t.response&&422===t.response.status&&Object($.a)(e,"danger",t.response.data.errors)}))},showInfo:function(e){var t=this;h.a.getInfo(e.path,this.userId).then((function(e){t.$emit("showInfoItem",e)})).catch((function(e){void 0!==e.response&&404===e.response.status&&Object($.a)(t,"danger",e.response.data.errors)}))},selectFile:function(e){this.$emit("selectFile",e)},getFilesAsync:function(e){var t=this;return Object(l.a)(r.a.mark((function n(){var i,a,s,l,d,c,u,f;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=[],a=[],t.firstUploadFolder=null,s=0;case 4:if(!(s<e.items.length)){n.next=24;break}if(l=e.items[s],!(d=l.webkitGetAsEntry()).isDirectory){n.next=19;break}if(null==t.firstUploadFolder&&(t.firstUploadFolder=d.name),"file"!==l.kind){n.next=17;break}if("function"!=typeof l.webkitGetAsEntry){n.next=15;break}return n.next=13,t.readEntryContentAsync(d);case 13:c=n.sent,a.push.apply(a,Object(o.a)(c));case 15:(u=l.getAsFile())&&i.push(u);case 17:n.next=21;break;case 19:(f=l.getAsFile())&&i.push(f);case 21:s++,n.next=4;break;case 24:return n.abrupt("return",{files:i,folders:a});case 25:case"end":return n.stop()}}),n)})))()},readEntryContentAsync:function(e){return new Promise((function(t){var n=0,i=[];function s(e){var r;!function(e){return e.isFile}(e)?function(e){return e.isDirectory}(e)&&(r=e.createReader(),n++,r.readEntries((function(e){n--;var r,o=Object(a.a)(e);try{for(o.s();!(r=o.n()).done;)s(r.value)}catch(e){o.e(e)}finally{o.f()}0===n&&t(i)}))):(n++,e.file((function(a){n--,a.filepath=e.fullPath.replace("/"+e.name,""),i.push(a),0===n&&t(i)})))}s(e)}))},uploadFiles:function(e){var t=this.formatFiles(e.files||[]),n=this.formatFiles(e.folders||[]);t.length>0&&this.$emit("uploadFiles",t,"files"),n.length>0&&this.$emit("uploadFiles",n,"folders",this.firstUploadFolder)},formatFiles:function(e){var t=this,n=[];return e.forEach((function(e){".DS_Store"!==e.name&&n.push({id:p()(e.name),preview:t.getPreview(e),type:e.type,name:e.name,size:f()(e.size),upload:!0,progress:0,error:!1,file:e})})),n},getPreview:function(e){return this.isImage(e)?URL.createObjectURL(e):e.name.split(".").pop()},isImage:function(e){return e.type.includes("image")},getFileById:function(e,t){return"folder_back"===t?this.$refs[e+"_"+t]:this.files.find((function(e){return e.id===t}))?this.$refs[e+"_"+t][0]:void 0},getParentFolder:function(){var e=this.current.split("/");return e.pop(),e.length?e.join("/"):"/"},rename:function(e,t){this.$emit("rename",e,t)},deleteData:function(e,t){this.$emit("delete",e,t)},select:function(e){this.$emit("select",e)}},computed:Object(i.a)(Object(i.a)({},Object(x.c)({settings:function(e){return e.settings.filemanager.scroll.settings},showModal:function(e){return e.settings.filemanager.showModal}})),{},{pathsLength:function(){return c.a.size(this.path)},filesCount:function(){return c.a.size(this.files)},filteredFiles:function(){var e=this,t=this.files;return this.search&&(t=this.files.filter((function(t){return t.name.toLowerCase().indexOf(e.search)>-1}))),this.filters.length>0&&(t=c.a.filter(t,(function(t){return"dir"===t.type||c.a.includes(e.filters,t.ext.toLowerCase())}))),t}})},j=(n(345),Object(w.a)(O,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"fileManagerContainer",attrs:{id:"filemanager-manager-container"}},[n("nav",{staticClass:"breadcrumb has-arrow-separator",attrs:{"aria-label":"breadcrumbs"}},[n("ul",[n("li",[n("a",{attrs:{href:"#",target:"_self"},on:{click:function(t){return t.preventDefault(),e.goToFolderNav(e.home)}}},[n("b-icon",{attrs:{icon:"folder-home"}})],1)]),e._v(" "),e._l(e.path,(function(t,i){return[e.checkIsLastItem(i)?n("li",{key:i,staticClass:"is-active"},[n("a",{attrs:{href:"#","aria-current":"page"}},[e._v(e._s(t.name))])]):n("li",{key:i},[n("a",{attrs:{href:"#",target:"_self"},on:{click:function(n){return n.preventDefault(),e.goToFolder(t.path)}}},[e._v(e._s(t.name))])])]}))],2)]),e._v(" "),n("vue-custom-scrollbar",{staticClass:"scroll-area",attrs:{tagname:"div",settings:e.settings}},[n("div",{staticClass:"files"},[n("div",[e.files.error?[n("div",{staticClass:"w-100 text-center my-4"},[n("h6",[e._v("У вас нет прав для просмотра этой папки")])])]:e._e(),e._v(" "),e.noFiles?[n("div",{staticClass:"w-100 text-center my-4"},[n("h6",[e._v("Нет файлов или папок в текущем каталоге")]),e._v(" "),!e.showModal&&"/"!==e.current&&e.buttons.delete_folder?n("b-button",{attrs:{type:"is-danger",size:"is-normal"},on:{click:e.removeDirectory}},[e._v("Удалить папку")]):e._e()],1)]:e._e(),e._v(" "),e.files.error?e._e():[[e.files.error?e._e():[e.parent.id?[n("div",{key:e.parent.id,staticClass:"grid"},[n("Folder",{ref:"folder_"+e.parent.id,staticClass:"folder-item",class:{loading:e.loadingInfo},attrs:{file:e.parent,"data-key":e.parent.id},on:{goToFolderEvent:e.goToFolder}})],1)]:e._e(),e._v(" "),e._l(e.filteredFiles,(function(t){return[n("div",{key:t.id,staticClass:"grid"},["file"===t.type?[n("ImageLoader",{ref:"file_"+t.id,refInFor:!0,staticClass:"file-item",attrs:{file:t,"data-key":t.id,"multi-selecting":e.multiSelecting,"selected-files":e.selectedFiles,"delete-permission":e.buttons.delete_file,"rename-permission":e.buttons.rename_file},on:{missing:function(t){return e.missing=t},showInfo:e.showInfo,rename:e.rename,delete:e.deleteData,select:e.select}})]:e._e(),e._v(" "),"dir"===t.type?[n("Folder",{ref:"folder_"+t.id,refInFor:!0,staticClass:"folder-item",class:{loading:e.loadingInfo},attrs:{file:t,"data-key":t.id,"multi-selecting":e.multiSelecting,"selected-files":e.selectedFiles,"delete-permission":e.buttons.delete_folder,"rename-permission":e.buttons.rename_folder},on:{goToFolderEvent:e.goToFolder,rename:e.rename,delete:e.deleteData,select:e.select}})]:e._e()],2)]}))]]]],2)])])],1)}),[],!1,null,"0850c8b2",null));t.a=j.exports},411:function(e,t,n){"use strict";var i=n(336);n.n(i).a},412:function(e,t,n){(e.exports=n(88)(!1)).push([e.i,".card[data-v-218f24d0] {\n  border-radius: 0;\n  border: 0;\n  display: flex;\n  flex-wrap: wrap;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  box-shadow: none !important;\n}\n.card img[data-v-218f24d0] {\n  max-width: 100%;\n  max-height: 80vh;\n  height: auto;\n  width: auto;\n}",""])},416:function(e,t,n){"use strict";var i=n(337);n.n(i).a},417:function(e,t,n){(e.exports=n(88)(!1)).push([e.i,"[data-v-3b05fe8e] .modal-info > div {\n  display: flex;\n}\n[data-v-3b05fe8e] .modal-info > div .box-preview {\n  width: 100%;\n  margin-right: 15px;\n  display: flex;\n  justify-content: center;\n}\n[data-v-3b05fe8e] .modal-info > div .box-info {\n  min-width: 400px;\n  display: flex;\n}\n[data-v-3b05fe8e] .modal-info > div .box-info .info-data {\n  width: 100%;\n}\n[data-v-3b05fe8e] .modal-info > div .box-info .info-data .info {\n  display: flex;\n  align-items: center;\n  font-size: 0.85rem;\n  margin-bottom: 0.5rem;\n}\n[data-v-3b05fe8e] .modal-info > div .box-info .info-data .info.url .title {\n  min-width: 65px;\n}\n[data-v-3b05fe8e] .modal-info > div .box-info .info-data .info.url .value {\n  display: flex;\n  width: 100%;\n  justify-content: space-between;\n}\n[data-v-3b05fe8e] .modal-info > div .box-info .info-data .info.url .value .control.is-clearfix {\n  width: 100%;\n}\n[data-v-3b05fe8e] .modal-info > div .box-info .info-data .info .title {\n  user-select: none;\n  font-weight: 700;\n  margin-right: 0.5rem;\n  margin-bottom: 0;\n  font-size: 0.85rem;\n  background: rgba(220, 220, 220, 0.3);\n  padding: 0.3rem;\n  border-radius: 4px;\n}\n[data-v-3b05fe8e] .modal-info > div .box-info .info-data .info span.value {\n  font-weight: 600;\n}\n[data-v-3b05fe8e] .modal-info > div .box-info .info-data .info div.value .control button {\n  padding-top: 0;\n  padding-bottom: 0;\n  font-size: 0.715rem;\n  height: 26px;\n}\n[data-v-3b05fe8e] .modal-info > div .box-info .info-data .info div.value .control.is-clearfix {\n  margin-right: 0.3rem;\n}\n[data-v-3b05fe8e] .modal-info > div .box-info .info-data .info div.value .control.is-clearfix input {\n  height: 26px;\n  font-size: 0.75rem;\n  box-sizing: border-box !important;\n}\n.no-preview > .svg-mime[data-v-3b05fe8e] {\n  width: 90px;\n  height: 90px;\n  fill: gainsboro;\n}",""])},420:function(e,t,n){"use strict";var i=n(340);n.n(i).a},421:function(e,t,n){(e.exports=n(88)(!1)).push([e.i,"[data-v-6bf4a3c0].stack-uploads {\n  right: 15px;\n  bottom: 15px;\n  width: 400px;\n  z-index: 99;\n  position: fixed;\n}\n[data-v-6bf4a3c0].stack-uploads .files {\n  background: white;\n  margin-top: 1rem;\n  box-shadow: 0 1px 1px rgba(30, 38, 56, 0.25), 0 2px 5px rgba(30, 38, 56, 0.15);\n  border-radius: 4px;\n  padding: 1.5rem;\n}\n[data-v-6bf4a3c0].stack-uploads .files > div {\n  display: flex;\n  flex-wrap: wrap;\n  text-align: center;\n  width: 100%;\n  flex-direction: column;\n}\n[data-v-6bf4a3c0].stack-uploads .files .preview img {\n  width: 4rem;\n  height: 4rem;\n  object-fit: cover;\n  border-radius: 4rem;\n  margin-bottom: 0.3rem;\n}\n[data-v-6bf4a3c0].stack-uploads .files .preview svg {\n  font-size: 2rem;\n  margin-bottom: 0.3rem;\n}",""])},513:function(e,t,n){"use strict";var i=n(347);n.n(i).a},514:function(e,t,n){(e.exports=n(88)(!1)).push([e.i,"[data-v-2622d3a1] .manual_upload > input[type=file] {\n  display: none;\n}\n[data-v-2622d3a1] .modal {\n  z-index: 999;\n}\n[data-v-2622d3a1] .modal#modal-info .animation-content {\n  max-width: 70vw !important;\n}\n[data-v-2622d3a1] .modal .modal-card-head {\n  border-bottom: 1px solid #e9eaee;\n}\n[data-v-2622d3a1] .modal .modal-card-head p {\n  font-size: 1.1rem !important;\n  font-weight: 700;\n  color: var(--mirage) !important;\n}\n[data-v-2622d3a1] .modal .modal-card-body {\n  padding: 30px 20px;\n}\n[data-v-2622d3a1] .modal .modal-card-body input {\n  font-size: 0.85rem;\n  height: 2.5rem;\n}\n[data-v-2622d3a1] .modal .modal-card-body .field.has-addons p.control span {\n  height: 2.5rem;\n}\n[data-v-2622d3a1] .modal .modal-card-body p.text {\n  margin-bottom: 0.5rem;\n}\n[data-v-2622d3a1] .modal .modal-card-body small.text-danger {\n  display: block;\n  line-height: 1.2;\n  color: var(--red);\n  font-weight: 600;\n}\n[data-v-2622d3a1] .modal .modal-card-foot,[data-v-2622d3a1] .modal .modal-card-head {\n  background-color: #e9eaee;\n}\n[data-v-2622d3a1] .buttons .button {\n  height: auto;\n}\n[data-v-2622d3a1] .buttons .button:not(.load),[data-v-2622d3a1] .buttons .button:not(.multiselect),[data-v-2622d3a1] .buttons .button:not(.removing) {\n  padding: 0.55rem 2rem;\n}\n[data-v-2622d3a1] .buttons .button.load {\n  padding: 0.55rem 1rem;\n}\n[data-v-2622d3a1] .buttons .button.load.rotate span.icon {\n  animation: fa-spin-data-v-2622d3a1 2s infinite linear;\n}\n[data-v-2622d3a1] .buttons .button.removing {\n  padding: 0.55rem 1rem;\n}\n[data-v-2622d3a1] .buttons .button.multiselect {\n  padding: 0.55rem 1rem;\n}\n[data-v-2622d3a1] .buttons .button.multiselect > span {\n  display: flex;\n  justify-content: space-between;\n}\n[data-v-2622d3a1] .buttons .button.multiselect > span small {\n  margin-right: calc(-.375em - 1px);\n  margin-left: 0.1875em;\n  display: flex;\n  align-self: end;\n  line-height: 1;\n}\n[data-v-2622d3a1] .buttons .button span.icon {\n  display: flex;\n}\n[data-v-2622d3a1] #filemanager-manager.card .card-content .content {\n  flex-direction: column;\n}\n@keyframes fa-spin-data-v-2622d3a1 {\n0% {\n    -webkit-transform: rotate(0deg);\n    transform: rotate(0deg);\n}\n100% {\n    -webkit-transform: rotate(359deg);\n    transform: rotate(359deg);\n}\n}",""])},527:function(e,t,n){"use strict";n.r(t);n(355),n(356),n(179),n(404),n(358),n(48),n(172),n(90);var i=n(3),a=n(0),s=n.n(a),r=(n(11),n(2)),o=n(91),l=n.n(o),d=n(162),c=(n(165),n(159)),u=n(160),f={props:{active:{type:Boolean,default:!1},current:{type:String,default:"/",required:!0},userId:{type:Number,default:0,required:!0}},data:function(){return{folderName:null,processing:!1,validation:{type:null,message:null}}},methods:{typing:function(){this.validation.type=null,this.validation.message=null},createFolder:function(){var e=this;this.processing=!0,d.a.createFolder(this.folderName,this.current,this.userId).then((function(t){e.handleClose(),u.a.$emit("refreshFilemanager"),e.folderName=null,e.processing=!1,Object(c.a)(e,"success",t.message)})).catch((function(t){void 0!==t.response&&422===t.response.status&&(e.validation.message=t.response.data.errors,e.validation.type="is-danger"),e.processing=!1}))},cancelCreate:function(){this.folderName=null,u.a.$emit("closeModal","create_folder")},handleClose:function(){this.cancelCreate()}}},m=n(47),p=Object(m.a)(f,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-modal",{attrs:{id:"modal-create-folder",active:e.active,"has-modal-card":"","trap-focus":"","on-cancel":e.handleClose},on:{"update:active":function(t){e.active=t}}},[n("div",{staticClass:"modal-card",staticStyle:{"max-width":"500px"}},[n("header",{staticClass:"modal-card-head"},[n("p",{staticClass:"modal-card-title"},[e._v("Создание папки")])]),e._v(" "),n("section",{staticClass:"modal-card-body"},[n("b-field",{attrs:{type:e.validation.type,message:e.validation.message}},[n("b-input",{attrs:{type:"text",placeholder:"Укажите название папки",expanded:"",autofocus:""},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.createFolder(t)},input:e.typing},model:{value:e.folderName,callback:function(t){e.folderName=t},expression:"folderName"}})],1)],1),e._v(" "),n("footer",{staticClass:"modal-card-foot"},[n("b-button",{attrs:{type:"is-secondary",size:"is-normal",disabled:e.processing},on:{click:e.handleClose}},[e._v("\n                Закрыть\n            ")]),e._v(" "),n("b-button",{attrs:{type:"is-success",size:"is-normal",disabled:e.processing,loading:e.processing},on:{click:function(t){return t.preventDefault(),e.createFolder(t)}}},[e._v("\n                Создать\n            ")])],1)])])}),[],!1,null,null,null).exports,h=(n(49),n(173),{props:{active:{type:Boolean,default:!1},userId:{type:Number,default:0,required:!0}},data:function(){return{name:null,type:null,path:null,processing:!1}},mounted:function(){var e=this;u.a.$on("delete",(function(t,n){e.type=t,e.path=n,e.name=n.replace(/^.*[\\/]/,"")}))},methods:{deleteData:function(){"folder"===this.type?this.deleteFolder():this.deleteFile()},deleteFolder:function(){var e=this;this.processing=!0,d.a.removeDirectory(this.path,this.userId).then((function(t){u.a.$emit("closeModal","delete"),u.a.$emit("refreshFilemanager"),Object(c.a)(e,"success",t.message),e.processing=!1})).catch((function(t){void 0!==t.response&&422===t.response.status&&Object(c.a)(e,"danger",t.response.data.errors),e.processing=!1}))},deleteFile:function(){var e=this;this.processing=!0,d.a.removeFile(this.path,this.userId).then((function(t){u.a.$emit("closeModal","delete"),u.a.$emit("refreshFilemanager"),Object(c.a)(e,"success",t.message),e.processing=!1})).catch((function(t){void 0!==t.response&&422===t.response.status&&Object(c.a)(e,"danger",t.response.data.errors),e.processing=!1}))},handleClose:function(){u.a.$emit("closeModal","delete")}}}),v=Object(m.a)(h,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-modal",{attrs:{id:"modal-delete-folder",active:e.active,"has-modal-card":"","trap-focus":"","on-cancel":e.handleClose},on:{"update:active":function(t){e.active=t}}},[n("div",{staticClass:"modal-card",staticStyle:{"max-width":"500px"}},[n("header",{staticClass:"modal-card-head"},[n("p",{staticClass:"modal-card-title"},[e._v("Удаление "+e._s("folder"===e.type?"папки: ":"файла: "+e.name))])]),e._v(" "),n("section",{staticClass:"modal-card-body"},["folder"===e.type?[n("p",{staticClass:"text"},[e._v("Вы уверены, что хотите удалить эту папку?")]),e._v(" "),n("small",{staticClass:"text-danger"},[e._v("Важно: папка и всё её содержимое будет удалено из вашего хранилища")])]:[n("p",{staticClass:"text"},[e._v("Вы уверены, что хотите удалить этот файл?")]),e._v(" "),n("small",{staticClass:"text-danger"},[e._v("Важно: файл будет удален из вашего хранилища")])]],2),e._v(" "),n("footer",{staticClass:"modal-card-foot"},[n("b-button",{attrs:{type:"is-secondary",size:"is-normal",disabled:e.processing},on:{click:e.handleClose}},[e._v("\n                Закрыть\n            ")]),e._v(" "),n("b-button",{attrs:{type:"is-danger",size:"is-normal",disabled:e.processing,loading:e.processing},on:{click:function(t){return t.preventDefault(),e.deleteData(t)}}},[e._v("\n                Удалить\n            ")])],1)])])}),[],!1,null,null,null).exports,g=n(25),b={props:{active:{type:Boolean,default:!1},userId:{type:Number,default:0,required:!0},selectedFiles:{type:Array,required:!0}},data:function(){return{processing:!1}},methods:{deleteData:function(){var e=this;return Object(r.a)(s.a.mark((function t(){var n,i,a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.processing=!0,n=Object(g.a)(e.selectedFiles),t.prev=2,n.s();case 4:if((i=n.n()).done){t.next=15;break}if("dir"!==(a=i.value).type){t.next=11;break}return t.next=9,e.deleteFolder(a);case 9:t.next=13;break;case 11:return t.next=13,e.deleteFile(a);case 13:t.next=4;break;case 15:t.next=20;break;case 17:t.prev=17,t.t0=t.catch(2),n.e(t.t0);case 20:return t.prev=20,n.f(),t.finish(20);case 23:e.processing&&(e.processing=!1),u.a.$emit("refreshFilemanager"),u.a.$emit("closeModal","multidelete");case 26:case"end":return t.stop()}}),t,null,[[2,17,20,23]])})))()},deleteFolder:function(e){var t=this;d.a.removeDirectory(e.path,this.userId).then((function(e){Object(c.a)(t,"success",e.message)})).catch((function(e){void 0!==e.response&&422===e.response.status&&Object(c.a)(t,"danger",e.response.data.errors)}))},deleteFile:function(e){var t=this;d.a.removeFile(e.path,this.userId).then((function(e){Object(c.a)(t,"success",e.message)})).catch((function(e){void 0!==e.response&&422===e.response.status&&Object(c.a)(t,"danger",e.response.data.errors)}))},handleClose:function(){u.a.$emit("closeModal","multidelete")}}},y=Object(m.a)(b,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-modal",{attrs:{id:"modal-multidelete",active:e.active,"has-modal-card":"","trap-focus":"","on-cancel":e.handleClose},on:{"update:active":function(t){e.active=t}}},[n("div",{staticClass:"modal-card",staticStyle:{"max-width":"500px"}},[n("header",{staticClass:"modal-card-head"},[n("p",{staticClass:"modal-card-title"},[e._v("Множественное удаление")])]),e._v(" "),n("section",{staticClass:"modal-card-body"},[[n("p",{staticClass:"text"},[e._v("Вы уверены, что хотите удалить выбранные файлы и/или папки?")]),e._v(" "),n("small",{staticClass:"text-danger"},[e._v("Важно: выбранные файлы, папки и их содержимое будут удалены из вашего хранилища")])]],2),e._v(" "),n("footer",{staticClass:"modal-card-foot"},[n("b-button",{attrs:{type:"is-secondary",size:"is-normal",disabled:e.processing},on:{click:e.handleClose}},[e._v("\n                Закрыть\n            ")]),e._v(" "),n("b-button",{attrs:{type:"is-danger",size:"is-normal",disabled:e.processing,loading:e.processing},on:{click:function(t){return t.preventDefault(),e.deleteData(t)}}},[e._v("\n                Удалить\n            ")])],1)])])}),[],!1,null,null,null).exports,_={props:{active:{type:Boolean,default:!1},userId:{type:Number,default:0,required:!0}},data:function(){return{name:null,type:null,path:null,nameWithoutExtension:null,processing:!1,validation:{type:null,message:null}}},watch:{extension:function(e){if(e){var t=this.name;this.nameWithoutExtension=t.replace(e,"")}}},computed:{extension:function(){if("folder"!==this.type){var e=/(?:\.([^.]+))?$/.exec(this.name);if(e)return e[0]}return""}},mounted:function(){var e=this;u.a.$on("rename",(function(t,n){e.type=t,e.path=n,e.name=n.replace(/^.*[\\/]/,"")}))},methods:{typing:function(){this.validation.type=null,this.validation.message=null},renamePath:function(){var e=this,t="folder"===this.type?this.name:this.nameWithoutExtension+this.extension;this.processing=!0,d.a.rename(this.path,t,this.userId).then((function(t){e.handleClose(),u.a.$emit("refreshFilemanager"),e.folderName=null,e.processing=!1,Object(c.a)(e,"success",t.message)})).catch((function(t){void 0!==t.response&&422===t.response.status&&(e.validation.message=t.response.data.errors,e.validation.type="is-danger"),e.processing=!1}))},cancelRename:function(){this.name=null,this.type=null,this.path=null,u.a.$emit("closeModal","rename")},handleClose:function(){this.cancelRename()}}},x=Object(m.a)(_,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-modal",{attrs:{id:"modal-rename-folder",active:e.active,"has-modal-card":"","trap-focus":"","on-cancel":e.handleClose},on:{"update:active":function(t){e.active=t}}},[n("div",{staticClass:"modal-card",staticStyle:{"max-width":"500px"}},[n("header",{staticClass:"modal-card-head"},[n("p",{staticClass:"modal-card-title"},[e._v("Переименование "+e._s("folder"===e.type?"папки":"файла"))])]),e._v(" "),n("section",{staticClass:"modal-card-body"},[n("b-field",{attrs:{type:e.validation.type,message:e.validation.message}},["folder"===e.type?n("b-input",{attrs:{type:"text",placeholder:e.name,expanded:"",autofocus:""},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.renamePath(t)},input:e.typing},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}):e._e(),e._v(" "),"folder"!==e.type?n("b-input",{attrs:{type:"text",placeholder:e.nameWithoutExtension,expanded:"",autofocus:""},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.renamePath(t)},input:e.typing},model:{value:e.nameWithoutExtension,callback:function(t){e.nameWithoutExtension=t},expression:"nameWithoutExtension"}}):e._e(),e._v(" "),"folder"!==e.type?n("p",{staticClass:"control"},[n("span",{staticClass:"button is-static"},[e._v(e._s(e.extension))])]):e._e()],1)],1),e._v(" "),n("footer",{staticClass:"modal-card-foot"},[n("b-button",{attrs:{type:"is-secondary",size:"is-normal",disabled:e.processing},on:{click:e.handleClose}},[e._v("\n                Закрыть\n            ")]),e._v(" "),n("b-button",{attrs:{type:"is-success",size:"is-normal",disabled:e.processing,loading:e.processing},on:{click:function(t){return t.preventDefault(),e.renamePath(t)}}},[e._v("\n                Переименовать\n            ")])],1)])])}),[],!1,null,null,null).exports,F=n(20),w=(n(335),n(181),n(174),{props:{file:{type:Object,default:function(){return{name:""}},required:!0},preview:{type:Boolean,default:!1,required:!1}},data:function(){return{images:[]}},methods:{closePreview:function(e){e.preventDefault(),e.stopPropagation()}},mounted:function(){this.preview&&this.images.push(this.file.image)}}),C=(n(411),Object(m.a)(w,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{ref:"card"},[this.preview?t("img",{key:this.file.id,attrs:{src:this.file.image,alt:""}}):this._e()])}),[],!1,null,"218f24d0",null).exports),k=n(413),I=n.n(k),$=(n(414),{props:{active:{type:Boolean,default:!1},info:{type:Object,default:function(){return{name:""}},required:!0}},components:{ImageInfo:C},data:function(){return{loaded:!1,currentInfo:{},nameNoExtension:null,nameWidth:null,inputElement:null,correctName:null}},methods:{closePreview:function(){this.correctName=null,this.$emit("closePreview",!0)},onCopy:function(){document.querySelector("#linkUrl").select();try{var e=document.execCommand("copy"),t="success",n="Ссылка была успешно скопирована";e||(t="danger",n="Ошибка копирования"),window.getSelection().removeAllRanges(),Object(c.a)(this,t,n)}catch(e){window.getSelection().removeAllRanges(),Object(c.a)(this,"danger","Упс, невозможно скопировать")}},selectFile:function(){this.closePreview(),this.$emit("selectFile",this.info)},handleClose:function(){this.closePreview()}},computed:{playerOptions:function(){return this.info?{video:{url:this.info.name},autoplay:!1,contextmenu:[{text:"GitHub",link:"https://github.com/MoePlayer/vue-dplayer"}]}:{}}},watch:{"info.type":function(e){"video"===e&&this.$nextTick((function(){var e=this;setTimeout((function(){new I.a(e.$refs.video)}))}))},"info.name":function(e){e&&(this.nameNoExtension=e.split(".").slice(0,-1).join("."))},nameNoExtension:function(e){e&&(this.nameWidth=7*(e.length+1))}}}),O=(n(416),Object(m.a)($,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-modal",{attrs:{id:"modal-info",active:e.active,"has-modal-card":"","trap-focus":"","on-cancel":e.handleClose},on:{"update:active":function(t){e.active=t}}},[n("div",{staticClass:"modal-card",staticStyle:{width:"70vw"}},[n("header",{staticClass:"modal-card-head"},[n("p",{staticClass:"modal-card-title"},[e._v("Превью: "+e._s(e.info.name))])]),e._v(" "),n("section",{staticClass:"modal-card-body modal-info"},[n("div",[n("div",{staticClass:"box-preview"},["image"===e.info.type?[n("ImageInfo",{staticClass:"card image",attrs:{file:e.info,preview:!0}})]:"video"===e.info.type?[n("video",{ref:"video",attrs:{controls:"",crossorigin:"",playsinline:""}},[n("source",{attrs:{src:e.info.url,type:e.info.mime}})])]:[n("object",{staticClass:"no-preview",domProps:{innerHTML:e._s(e.info.image)}})]],2),e._v(" "),n("div",{staticClass:"box-info"},[n("div",{staticClass:"info-data"},[n("div",{staticClass:"info"},[n("span",{staticClass:"title"},[e._v("Название:")]),e._v(" "),n("span",{staticClass:"value"},[e._v(e._s(e.info.name))])]),e._v(" "),e.info.mime?n("div",{staticClass:"info"},[n("span",{staticClass:"title"},[e._v("Тип:")]),e._v(" "),n("span",{staticClass:"value"},[e._v(e._s(e.info.mime))])]):e._e(),e._v(" "),e.info.date?n("div",{staticClass:"info"},[n("span",{staticClass:"title"},[e._v("Последняя модификация:")]),e._v(" "),n("span",{staticClass:"value"},[e._v(e._s(e.info.date))])]):e._e(),e._v(" "),e.info.size?n("div",{staticClass:"info"},[n("span",{staticClass:"title"},[e._v("Вес:")]),e._v(" "),n("span",{staticClass:"value"},[e._v(e._s(e.info.size))])]):e._e(),e._v(" "),e.info.dimensions?n("div",{staticClass:"info"},[n("span",{staticClass:"title"},[e._v("Размеры:")]),e._v(" "),n("span",{staticClass:"value"},[e._v(e._s(e.info.dimensions))])]):e._e(),e._v(" "),e.info.url?n("div",{staticClass:"info url"},[n("span",{staticClass:"title"},[e._v("Ссылка")]),e._v(" "),n("div",{staticClass:"value"},[n("b-input",{attrs:{value:e.info.url,id:"linkUrl"}}),e._v(" "),n("p",{staticClass:"control"},[n("b-button",{attrs:{type:"is-success"},on:{click:function(t){return t.preventDefault(),e.onCopy(t)}}},[e._v("Скопировать")])],1)],1)]):e._e()])])])]),e._v(" "),n("footer",{staticClass:"modal-card-foot"},[n("b-button",{attrs:{type:"is-secondary",size:"is-normal"},on:{click:e.handleClose}},[e._v("\n                Закрыть\n            ")])],1)])])}),[],!1,null,"3b05fe8e",null).exports),j=(n(338),n(182),n(183),n(339),n(1)),S=n.n(j),P={props:{type:{type:String,default:"files",required:!1}}},D=Object(m.a)(P,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticStyle:{"margin-top":".5rem"}},[(this.type,t("b-progress",{attrs:{type:"is-primary",size:"is-small"}}))],1)}),[],!1,null,null,null).exports,E=document.head.querySelector('meta[name="csrf-token"]'),q={props:{current:{type:String,default:"/",required:!0},userId:{type:String,default:0,required:!0},visibility:{type:String,default:"public"},rules:{type:Array,default:[],required:!1}},components:{"progress-module":D},data:function(){return{token:E.content,files:[],filesUploaded:[],type:"files",error:!1}},methods:{isImage:function(e){return e.type.includes("image")},getRandomArbitrary:function(e,t){return Math.random()*(t-e)+e},startUploadingFiles:function(e,t){this.files=e,this.type=t,this.filesUploaded=[],this.processFiles()},processFiles:function(){var e=this;return Object(r.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Array.from(e.files).forEach((function(t){e.startUpload(t)}));case 1:case"end":return t.stop()}}),t)})))()},startUpload:function(e){var t={headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(t){e.progress=parseInt(Math.round(100*t.loaded/t.total))}},n="/";e.file.webkitRelativePath?n=e.file.webkitRelativePath.replace("/"+e.file.name,""):e.file.filepath&&(n=e.file.filepath);var i=new FormData;i.append("file",e.file),i.append("userId",this.userId),i.append("current",this.current+"/"+n),i.append("visibility",this.visibility),"files"===this.type?(i.append("rules",JSON.stringify(this.rules)),this.uploadFileToServer(e,i,t)):this.uploadFolderToServer(e,i,t)},uploadFileToServer:function(e,t,n){var i=this;S.a.post("/api/filemanager/uploads/add",t,n).then((function(t){l.a.forEach(i.files,(function(e){e.name===t.data.name&&(e.upload=!0)})),i.filesUploaded.push(e.id),setTimeout((function(){i.$emit("removeFile",e.id)}),2e3)})).catch((function(t){void 0!==t.response&&422===t.response.status&&Object(c.a)(i,"danger",t.response.data.errors),e.error=!0,setTimeout((function(){i.$emit("removeFile",e.id)}),1e3)}))},uploadFolderToServer:function(e,t,n){var i=this;t.append("folder",!0),S.a.post("/api/filemanager/uploads/add",t,n).then((function(t){l.a.forEach(i.files,(function(e){e.name===t.data.name&&(e.upload=!0)})),i.filesUploaded.push(e.id),setTimeout((function(){i.$emit("removeFile",e.id)}),2e3)})).catch((function(t){void 0!==t.response&&422===t.response.status&&Object(c.a)(i,"danger",t.response.data.errors),i.error=!0,setTimeout((function(){i.$emit("removeFile",e.id)}),1e3)}))}},filters:{truncate:function(e,t,n){return e.slice(0,t)+(t<e.length?n||"...":"")}}},M=(n(420),Object(m.a)(q,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.files.length>0?n("div",{staticClass:"stack-uploads"},e._l(e.files,(function(t,i){return n("div",{key:i,staticClass:"files"},[n("transition",{attrs:{name:"fade",mode:"out-in"}},[t.upload?n("div",{key:i},[n("div",{staticClass:"preview"},[e.isImage(t)?n("img",{attrs:{src:t.preview,alt:"upload"}}):n("div",{staticClass:"rounded-full bg-50 w-12 h-12 flex justify-center items-center"},[n("div",{staticClass:"uppercase"},[e._v("\n                                "+e._s(t.preview)+"\n                            ")])])]),e._v(" "),n("small",[t.error?[n("small",{staticClass:"text-danger"},[e._v("Error on upload")])]:[e._v("\n                            "+e._s(e._f("truncate")(t.name,15))+"\n                            "),100===t.progress?n("small",{staticClass:"text-success"},[e._v("Success")]):e._e(),e._v(" "),n("progress-module")]],2)]):e._e()])],1)})),0):e._e()}),[],!1,null,"6bf4a3c0",null).exports),T={name:"Filemanager",components:{"create-folder":p,"rename-modal":x,"confirm-modal-delete":v,"confirm-modal-multi-delete":y,manager:n(353).a,DetailPopup:O,UploadProgress:M},data:function(){return{modal:{create_folder:!1,multidelete:!1,rename:!1,delete:!1,info:!1},loadingfiles:!1,showUpload:!1,currentPath:"/",files:[],parent:{},path:[],noFiles:!1,info:{},filesToUpload:[],uploadType:null,folderUploadedName:null,search:"",filters:[],filterBy:"",filteredExtensions:[],showFilters:!1,multiSelecting:!1,selectedFiles:[],buttons:[]}},created:function(){var e=this;return Object(r.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.$route.query.path&&(e.currentPath=e.$route.query.path),t.next=3,e.getData(e.currentPath);case 3:case"end":return t.stop()}}),t)})))()},mounted:function(){var e=this;u.a.$on("refreshFilemanager",(function(){e.refreshCurrent()})),u.a.$on("closeModal",(function(t){e.modal[t]=!1})),u.a.$on("openModal",(function(t){e.modal[t]=!0}))},computed:Object(i.a)({},Object(F.b)(["user"])),methods:{getData:function(e){var t=this;return this.files=[],this.parent={},this.path=[],this.noFiles=!1,this.loadingfiles=!0,d.a.getData(e,this.user.id).then((function(e){0===l.a.size(e.files)&&(t.noFiles=!0),t.files=e.files,t.path=e.path,t.filters=e.filters,t.parent=e.parent,t.buttons=e.buttons,t.loadingfiles=!1})).catch((function(e){void 0!==e.response&&422===e.response.status&&(t.loadingfiles=!1,t.filters=[],Object(c.a)(t,"danger",e.response.data.errors))}))},refreshCurrent:function(){this.multiSelecting&&this.refreshMultiSelected(),this.getData(this.currentPath)},goToFolder:function(e){this.getData(e),this.currentPath=e,"/"===this.currentPath?history.pushState(null,null,"/settings/filemanager"):history.pushState(null,null,"/settings/filemanager?path="+e)},goToFolderNav:function(e){this.getData(e),this.currentPath=e,"/"===this.currentPath?history.pushState(null,null,"/settings/filemanager"):history.pushState(null,null,"/settings/filemanager?path="+e)},showInfoItem:function(e){this.info=e,this.modal.info=!0},closePreview:function(){this.info={},this.modal.info=!1},uploadFiles:function(e,t,n){this.filesToUpload=e,this.uploadType=t,this.folderUploadedName=n,this.$refs.uploader.startUploadingFiles(e,t)},removeFileFromUpload:function(e){var t=this.filesToUpload.map((function(e){return e.id})).indexOf(e);this.$delete(this.filesToUpload,t),0===this.filesToUpload.length&&(this.folderUploadedName=null,this.uploadType=null,this.refreshCurrent())},uploadFilesByButton:function(e){this.$refs.manager.uploadFiles({files:Array.from(e.target.files)},"files")},refreshMultiSelected:function(){this.multiSelecting=!1,this.selectedFiles=[]},filterFiles:function(){var e=l.a.get(this.filters,this.filterBy);null==e&&(this.filteredExtensions=[]),null!=e&&e.length>0&&(this.filteredExtensions=e)},searchItems:l.a.debounce((function(e){this.search=e.target.value}),300),select:function(e){var t=l.a.findIndex(this.selectedFiles,e);t>=0?this.selectedFiles.splice(t,1):this.selectedFiles.push(e)}},watch:{currentPath:function(){this.multiSelecting=!1,this.selectedFiles=[]},filters:function(){if(this.filters&&l.a.size(this.filters)>1)return this.showFilters=!0,!0;this.showFilters=!1}}},z=(n(513),Object(m.a)(T,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"content--main"},[n("h3",[e._v("Менеджер файлов")]),e._v(" "),n("create-folder",{attrs:{current:e.currentPath,active:e.modal.create_folder,userId:e.user.id}}),e._v(" "),n("rename-modal",{attrs:{active:e.modal.rename,userId:e.user.id}}),e._v(" "),n("confirm-modal-delete",{attrs:{active:e.modal.delete,userId:e.user.id}}),e._v(" "),n("confirm-modal-multi-delete",{attrs:{"selected-files":e.selectedFiles,active:e.modal.multidelete,userId:e.user.id}}),e._v(" "),n("div",{staticClass:"card filemanager",attrs:{id:"filemanager-manager"}},[n("div",{staticClass:"card-content"},[n("div",{staticClass:"content"},[n("div",{staticClass:"buttons"},[n("b-button",{staticClass:"load",class:{rotate:e.loadingfiles},attrs:{type:"is-primary"},on:{click:e.refreshCurrent}},[n("b-icon",{attrs:{icon:"sync",size:"is-normal"}})],1),e._v(" "),e.buttons.upload_button?n("label",{staticClass:"manual_upload"},[n("div",{staticClass:"button is-primary",on:{click:function(t){e.showUpload=!e.showUpload}}},[e._v("\n                            Загрузить\n                        ")]),e._v(" "),n("input",{attrs:{type:"file",multiple:""},on:{change:e.uploadFilesByButton}})]):e._e(),e._v(" "),e.buttons.create_folder?n("b-button",{attrs:{type:"is-primary"},on:{click:function(t){t.preventDefault(),e.modal.create_folder=!e.modal.create_folder}}},[e._v("\n                        Создать папку\n                    ")]):e._e(),e._v(" "),e.buttons.select_multiple?n("b-button",{staticClass:"multiselect",attrs:{type:"is-primary"},on:{click:function(t){e.multiSelecting=!e.multiSelecting}}},[n("b-icon",{attrs:{icon:"folder-plus",size:"is-normal"}}),e._v(" "),e.selectedFiles.length>0?n("small",[e._v(e._s(e.selectedFiles.length))]):e._e()],1):e._e(),e._v(" "),e.multiSelecting&&e.selectedFiles.length>0?n("b-button",{staticClass:"removing",attrs:{type:"is-danger"},on:{click:function(t){t.preventDefault(),e.modal.multidelete=!e.modal.multidelete}}},[n("b-icon",{attrs:{icon:"delete",size:"is-normal"}})],1):e._e()],1),e._v(" "),n("manager",{ref:"manager",attrs:{files:e.files,userId:e.user.id,path:e.path,current:e.currentPath,parent:e.parent,noFiles:e.noFiles,search:e.search,filters:e.filteredExtensions,"multi-selecting":e.multiSelecting,"selected-files":e.selectedFiles,buttons:e.buttons},on:{goToFolderManager:e.goToFolder,goToFolderManagerNav:e.goToFolderNav,uploadFiles:e.uploadFiles,showInfoItem:e.showInfoItem,select:e.select}}),e._v(" "),n("DetailPopup",{ref:"detailPopup",attrs:{info:e.info,active:e.modal.info},on:{closePreview:e.closePreview}}),e._v(" "),n("UploadProgress",{ref:"uploader",attrs:{current:e.currentPath,userId:e.user.id},on:{removeFile:e.removeFileFromUpload}})],1)])])],1)}),[],!1,null,"2622d3a1",null));t.default=z.exports}}]);